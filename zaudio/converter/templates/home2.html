<html>
<head>
<title> Zaudio - Audio Converter </title>

  {% load bootstrap5 %}
  {% bootstrap_css %}

<nav class="navbar navbar-expand-lg navbar-light bg-primary text-light">
<center style="font-size:30px;margin:10px;padding:5px;" class="border border-dark rounded bg-dark"> 
Zaudio
 </center>
<font style="font-size:27px;">
Audio converter
</font>
</nav> 

</head>

<body>
<div style="margin-top:50px;" class="border border-dark rounded bg-light container container-sm">
<font class="font-size:25px;">  </font><br>

{% for file in files %}
<font class="font-size:35px;"> {{file}} </font> <button id="{{file}}" class="btn btn-info">  Converting <span class="spinner-border spinner-border-sm"></span></button>

{% endfor %}
<br>
</form>

</div>


</body>
<script>
{% for file in files %}
function file_{{forloop.counter}}() {
var x=document.getElementById("{{file}}");
var done=404;
var done2=0
var url="/checkfile/";
function dd() {
var done;
   fetch(url,{
        method:'POST',
        headers:{ 'Content-Type':'application/json',},
        body: JSON.stringify({'file':'{{file}}'})
        })

   .then((response)=>{ done=response['status'];
console.log("done: ",done)  
})

    .then((data) => { return 0 })
return 404;
}

while(done==404){

done=dd()
console.log("fk",done)
}

console.log("done with file {{file}}");
}

file_{{forloop.counter}}()
{% endfor %}
</script>
</html>
